<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Resource Tester with Debug Info</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .controls {
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: #45a049;
      }
      button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
      #startBtn {
        background-color: #4caf50;
      }
      #resetBtn {
        background-color: #f44336;
      }
      #calculateBtn {
        background-color: #2196f3;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }
      th {
        background-color: #f2f2f2;
        position: sticky;
        top: 0;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      tr.testing {
        background-color: #fff9c4;
      }
      tr.completed {
        background-color: #e8f5e9;
      }
      tr.error {
        background-color: #ffebee;
      }
      .summary-card {
        background-color: #e3f2fd;
        border-radius: 8px;
        padding: 15px;
        margin-top: 20px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .summary-card h2 {
        margin-top: 0;
        color: #1565c0;
      }
      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }
      .summary-item {
        background-color: white;
        padding: 15px;
        border-radius: 4px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .summary-item h3 {
        margin-top: 0;
        color: #333;
        font-size: 16px;
      }
      .summary-item p {
        margin-bottom: 0;
        font-size: 24px;
        font-weight: bold;
        color: #1565c0;
      }
      #videoContainer {
        display: none;
      }
      .progress-container {
        margin-top: 10px;
        background-color: #f5f5f5;
        border-radius: 4px;
        height: 20px;
        position: relative;
      }
      .progress-bar {
        height: 100%;
        background-color: #4caf50;
        border-radius: 4px;
        width: 0%;
        transition: width 0.3s;
      }
      .progress-text {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        text-align: center;
        line-height: 20px;
        color: white;
        font-weight: bold;
        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
      }
      .resources-list {
        margin-bottom: 20px;
        background-color: #f5f5f5;
        padding: 15px;
        border-radius: 4px;
      }
      .resources-list h2 {
        margin-top: 0;
        color: #333;
      }
      .resources-list ul {
        margin: 0;
        padding-left: 20px;
      }
      .resources-list li {
        margin-bottom: 5px;
      }
      .debug-info {
        background-color: #f0f8ff;
        border: 1px solid #b0c4de;
        border-radius: 4px;
        padding: 10px;
        margin-top: 10px;
        font-family: monospace;
        font-size: 12px;
        max-height: 200px;
        overflow-y: auto;
      }
      .debug-info h4 {
        margin-top: 0;
        margin-bottom: 5px;
        color: #333;
      }
      .debug-info pre {
        margin: 0;
        white-space: pre-wrap;
      }
      .debug-toggle {
        cursor: pointer;
        color: #1565c0;
        text-decoration: underline;
        font-size: 14px;
        margin-top: 5px;
        display: inline-block;
      }
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1>Video Resource Tester with Debug Info</h1>

    <div class="resources-list">
      <h2>Hardcoded Resources</h2>
      <ul id="resourcesList"></ul>
    </div>

    <div class="controls">
      <button id="startBtn">Start</button>
      <button id="resetBtn" disabled>Reset</button>
      <button id="calculateBtn" disabled>Calculate</button>
    </div>

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-text" id="progressText">0%</div>
    </div>

    <table id="resultsTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Resource URL</th>
          <th>Waiting Time (ms)</th>
          <th>Download Speed</th>
          <th>Status</th>
          <th>Debug Info</th>
        </tr>
      </thead>
      <tbody id="resultsBody"></tbody>
    </table>

    <div class="summary-card" id="summaryCard" style="display: none">
      <h2>Test Results Summary</h2>
      <div class="summary-grid">
        <div class="summary-item">
          <h3>Average Waiting Time</h3>
          <p id="avgWaitingTime">-</p>
        </div>
        <div class="summary-item">
          <h3>Average Download Speed</h3>
          <p id="avgDownloadSpeed">-</p>
        </div>
        <div class="summary-item">
          <h3>Total Resources</h3>
          <p id="totalResources">-</p>
        </div>
        <div class="summary-item">
          <h3>Successful Tests</h3>
          <p id="successfulTests">-</p>
        </div>
      </div>
    </div>

    <div id="videoContainer"></div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // DOM Elements
        const startBtn = document.getElementById("startBtn");
        const resetBtn = document.getElementById("resetBtn");
        const calculateBtn = document.getElementById("calculateBtn");
        const resultsBody = document.getElementById("resultsBody");
        const videoContainer = document.getElementById("videoContainer");
        const summaryCard = document.getElementById("summaryCard");
        const avgWaitingTimeEl = document.getElementById("avgWaitingTime");
        const avgDownloadSpeedEl = document.getElementById("avgDownloadSpeed");
        const totalResourcesEl = document.getElementById("totalResources");
        const successfulTestsEl = document.getElementById("successfulTests");
        const progressBar = document.getElementById("progressBar");
        const progressText = document.getElementById("progressText");
        const resourcesList = document.getElementById("resourcesList");

        // Hardcoded resources list
        const resources = [
    "https://v16m.tiktokcdn-us.com/58f4e34afb0af390b491e294c5ebd22e/684a653a/video/tos/useast5/tos-useast5-pve-0068-tx/oYWHxgQiIERtJxEDLvoEkDbBJEueSGOfgAWFIR/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2146&bt=1073&cs=0&ds=6&ft=GSDrKInz7ThYWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZGhnOGc2Z2RoNjY7ZjdoZkBpM2tucWo5cmtlMzMzZzczNEBeMTNjMjY1XzMxLi4tNi5fYSNlYGkyMmRzbGZhLS1kMS9zcw%3D%3D&vvpl=1&l=20250611232649423A6E6CAD109E066C4E&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/f78d655a459a5d22136a651aff82bde9/684a5887/video/tos/useast5/tos-useast5-pve-0068-tx/oUTNDifDSQ7CRInEjGJcKiNxLBlAYEbfFgMmIg/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1926&bt=963&cs=0&ds=6&ft=GSDrKInz7TharuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Zjs6OzxlN2Y7Mzk4aTxlO0BpMzk3c3c5cnNreDMzZzczNEAzYl9fYDQyXjIxNGFfXzQzYSNrNWpsMmRrYTJgLS1kMS9zcw%3D%3D&vvpl=1&l=202506112232159C54683D5BD2CE1AF38A&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/a0aa6be5bfb07193a6ce3e85c351770a/684a5cfe/video/tos/useast5/tos-useast5-ve-0068c002-tx/oMigODfEIg9SnlCSTIBXRlAfDGQmF7EZDonIDp/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1896&bt=948&cs=0&ds=6&ft=GSDrKInz7Th4ouqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZTVoZzNnaTM8NDo5ZTs7PEBpajpxcm45cnM7eTMzZzczNEAtNC0uYTVgXzYxLzAxL2BfYSMtMm8xMmRjX25gLS1kMS9zcw%3D%3D&vvpl=1&l=202506112252002077C905FCA869054622&btag=e000b8000",
    "https://v16m.tiktokcdn-us.com/8224eafa582ce5b6311babb57d2c133f/684a5d18/video/tos/useast5/tos-useast5-pve-0068-tx/o0UCxA6udSQlcEEn38FfDBgkG1ZgOPIeRID1EQ/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=3432&bt=1716&cs=0&ds=6&ft=GSDrKInz7Th4ouqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZTZmM2VlZzM1OjM8PGg0M0BpajltOHQ5cjd3eTMzZzczNEAuLjU0MjZeNTUxYzEzXi8uYSM0aDBzMmQ0NGxgLS1kMS9zcw%3D%3D&vvpl=1&l=202506112252002077C905FCA869054622&btag=e00088000",
    "https://v19.tiktokcdn-us.com/78452e4447e3ce0d4a8e4f29883203c2/684a57fc/video/tos/useast5/tos-useast5-ve-0068c001-tx/os8RMZYifgQHiocekKUWhdNQRCMApfASfA8f7O/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2624&bt=1312&cs=0&ds=6&ft=GSDrKInz7Th-6uqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OWlnZWZlNmhpaTQ1Zjg2OEBpM2k1N3E5cnE5eTMzZzczNEAxLl80LWFiNl8xMWNfYjEtYSMwNnBpMmRzNl5gLS1kMS9zcw%3D%3D&vvpl=1&l=202506112230413A3395AF2D4BE0049995&btag=e000b0000",
    "https://v16m.tiktokcdn-us.com/a371060be28727080b79c71627185705/684a58fe/video/tos/useast5/tos-useast5-ve-0068c001-tx/o8fRyOEUyEBKl5SPE1rtzvgIDfAuFDQMzBtncE/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2206&bt=1103&cs=0&ds=6&ft=GSDrKInz7ThiIuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=aGg2ZjM6NTw2Ojw5NWVoO0Bpajk4aHM5cnV2djMzZzczNEAyM142Y2JeNV8xMDIxMWBeYSNjZ2stMmRjaXBgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611223434BE432A12BB0FA31AA852&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/7740f5ae2ec2ba79c3dc76a52a102f93/684a64da/video/tos/useast5/tos-useast5-ve-0068c001-tx/og5EEHTiRSuf4o0H9gQfPE2EIAco58BtpXLDiB/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2180&bt=1090&cs=0&ds=6&ft=GSDrKInz7Th9ZSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Mzo5ZGg4aTQ5OzozNWVpPEBpajc6ZXY5cmV5MzMzZzczNEA1NTMtLWA1NWMxXzJiYy9iYSMwZGtiMmRzNTZhLS1kMS9zcw%3D%3D&vvpl=1&l=20250611232447669533BBBBF2CB06663E&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/f418d8e98a1deca4749ebeccd1d0acd9/684a5d21/video/tos/useast5/tos-useast5-ve-0068c003-tx/okoSkQzIG85MqCUeAIebANgekLtlMQHIFbCjrl/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2120&bt=1060&cs=0&ds=6&ft=GSDrKInz7Th4ouqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Zjs2ZWhpOWVkOjo6NmhlM0Bpaml2cHA5cjlvMzMzZzczNEA2X2EvYS8zXy8xMGBeXjZiYSMtZl9xMmRjMGZhLS1kMS9zcw%3D%3D&vvpl=1&l=202506112252002077C905FCA869054622&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/2b429d73b728981c85d0db17c15ecd42/684a5d09/video/tos/useast8/tos-useast8-ve-0068c003-tx2/owYUVFDhREEiME3o35EIUOBAgQeA8lCKOofx30/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1876&bt=938&cs=0&ds=6&ft=GSDrKInz7Th4ouqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Ojg1NDY4OTo4aTM8MzY5PEBpanFvNWw5cmRyMzMzaTczNEBjMmEyY2BjXjUxX2M1Xy4uYSNscWRpMmQ0NHBhLS1kMTJzcw%3D%3D&vvpl=1&l=202506112252002077C905FCA869054622&btag=e000b8000",
    "https://v16m.tiktokcdn-us.com/1132385d07b6cc710657fa30d5d59b3d/684a5d2f/video/tos/useast5/tos-useast5-ve-0068c003-tx/owtyIkIG5PeHsmHQpO0BIxfEqHLYijAgfxC1OA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2042&bt=1021&cs=0&ds=6&ft=GSDrKInz7Th4ouqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Zzg6aDNoO2VmaDQ6OjxpNUBpanJ5eHM5cnB0dzMzZzczNEAyLy4wNGBjXjMxYDVhMl5gYSNzYDJlMmQ0YC1gLS1kMS9zcw%3D%3D&vvpl=1&l=202506112252002077C905FCA869054622&btag=e00090000",
    "https://v16m.tiktokcdn-us.com/de2cec462ec5e8836a76c4f7f75e3664/684a6544/video/tos/useast8/tos-useast8-ve-0068c001-tx2/ooZg3B1oQGTflURffELjAvRIGAM6ASjeRVFgG0/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2102&bt=1051&cs=0&ds=6&ft=GSDrKInz7ThCWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OmRmOWRoN2dnaTlpaTs8ZEBpanc4OW05cnZ0MzMzaTczNEBeXjUyMl4zNmIxMC80XjE0YSM1NWUwMmRjX3NhLS1kMTJzcw%3D%3D&vvpl=1&l=202506112326516FCB195F3DD7A905DB6A&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/d11dcf4709dc9109d27bb57382d54e7c/684a6528/video/tos/useast8/tos-useast8-pve-0068-tx2/oEE8CoGBZ33EEKFRjCIgAiAVC2AfaZoIYKRQeD/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1440&bt=720&cs=0&ds=6&ft=GSDrKInz7ThCWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=NDY2NzM5PDpmNDZpOGRmO0BpajQ4aW45cnA5NDMzaTczNEBfLWMwNjQxNjExLzA1Ly81YSMza2QzMmRjby9hLS1kMTJzcw%3D%3D&vvpl=1&l=202506112326516FCB195F3DD7A905DB6A&btag=e000b0000",
    "https://v16m.tiktokcdn-us.com/2fb2034bf517b71b05d859f84e770cb7/684a654f/video/tos/useast5/tos-useast5-ve-0068c003-tx/o8MeUTUNMIfTCMmeADXgQ9MvuK8KfTcQQEAeiM/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=3002&bt=1501&cs=0&ds=6&ft=GSDrKInz7ThCWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=PDU5aTtoZDk6Z2RlPGc0NEBpanF2dXY5cm83eTMzZzczNEAtLi8yMS1hXmIxYi40LzBgYSMtMHFsMmRzczNgLS1kMS9zcw%3D%3D&vvpl=1&l=202506112326516FCB195F3DD7A905DB6A&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/e7a297e86dac09718a903b8fda8fc802/684a58a4/video/tos/useast8/tos-useast8-pve-0068-tx2/og3zlqiiCAmyQIJDAIibhNqBfPkPUJhiiCAMME/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2138&bt=1069&cs=0&ds=6&ft=GSDrKInz7Th3kuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OGVkZ2VkODg0Zzs6ODNpNUBpamk8c2w5cnk2djMzaTczNEAxMzUwLTUvNTIxLmMvNC4wYSNhNTFvMmQ0LzNgLS1kMTJzcw%3D%3D&vvpl=1&l=202506112233211D59F4FF79563304AF9F&btag=e000b8000",
    "https://v16m.tiktokcdn-us.com/1d7c840d050b4134b4ad5e4ae75e15b7/684a63fb/video/tos/useast8/tos-useast8-pve-0068-tx2/oEELIVkfYclQ1VERZEqmFgFd6JfDAFAEAjqzTB/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2472&bt=1236&cs=0&ds=6&ft=GSDrKInz7ThfauqKXq8Zmo&mime_type=video_mp4&qs=0&rc=aTY8ODk8aDVoMzgzaDtpZkBpamxlO285cnBydDMzaTczNEBgNi4wMjMxXjYxXmE2NC4tYSNyMDAuMmRjYmhgLS1kMTJzcw%3D%3D&vvpl=1&l=20250611232127FC31680AEBE486065BD4&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/546eb369c6ba407e66c6716c8007821b/684a611b/video/tos/useast5/tos-useast5-ve-0068c004-tx/oITMMQA3QefguDiCIKxefQWGzxyM1c80igAZfT/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1452&bt=726&cs=0&ds=6&ft=GSDrKInz7ThgpuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=NmY2ZTw5NmU8NzU4NTo6NEBpamlxdW45cnR3eTMzZzczNEAxMi1fYTJeXjExYi8zMjY0YSNwazRfMmRjNGxgLS1kMS9zcw%3D%3D&vvpl=1&l=2025061123090703DE30003F5C3D1CA87B&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/dbe9e2c2ed22a26f67d1c39d75d9df1b/684a654d/video/tos/useast8/tos-useast8-ve-0068c004-tx2/oAEEPABfgBjiCiI3zYaxCQqCAIZ5AH7EJM4kiT/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2988&bt=1494&cs=0&ds=6&ft=GSDrKInz7ThCWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OWQzNjY8aGk5ZzQ7aTYzO0BpM3R3NHI5cmtqeTMzaTczNEAtYTFgYWMuXmExYzUwNDY1YSNkM3JgMmQ0MnBgLS1kMTJzcw%3D%3D&vvpl=1&l=202506112326516FCB195F3DD7A905DB6A&btag=e00088000",
    "https://v19.tiktokcdn-us.com/adfb97849b2b99b9521d6a70f11b95ba/684a59fc/video/tos/useast8/tos-useast8-pve-0068-tx2/o8N0UkAKPBTlQyEsCFiZ7D1LiR4bBrIVEk2IA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1856&bt=928&cs=0&ds=6&ft=GSDrKInz7ThvSuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OGk6N2Q0OzYzNTtkaTM5PEBpanVoc2w5cjtteDMzaTczNEBeLV4wMjQvXy0xL2E2M2BeYSNuNV4uMmQ0YC9gLS1kMTJzcw%3D%3D&vvpl=1&l=20250611223905CBB3C4B7A618E504CA12&btag=e000b8000",
    "https://v16m.tiktokcdn-us.com/c5b2c84e187b15f626d58c1b0b98079b/684a5a18/video/tos/useast5/tos-useast5-pve-0068-tx/o4gegUX7PKQNGT7ecAMAROfJMxfA0KfiUaQL83/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1658&bt=829&cs=0&ds=6&ft=GSDrKInz7ThPSuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ODpnZ2Y8OzQ2ODo8Ozo4Z0Bpajc4NXM5cmtneTMzZzczNEBgMmNfLl8vXjIxNGFfNDQwYSNuc140MmRrMHNgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611223902E70512341C1D28045A1A&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/89956aa342e05f40a749a8703265c15c/684a6532/video/tos/useast5/tos-useast5-pve-0068-tx/oEYKISED3ffDRjaQhoo2EbtEADF8nRANNXBNgg/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2698&bt=1349&cs=0&ds=6&ft=GSDrKInz7ThCWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ODRoN2U1aDc3ZjxlNWY4PEBpanVvc2s5cjg7MzMzZzczNEA0MzBiYDAuXi4xMmIyMmJjYSNqL21zMmRzMm9hLS1kMS9zcw%3D%3D&vvpl=1&l=202506112326516FCB195F3DD7A905DB6A&btag=e000b8000",
    "https://v16m.tiktokcdn-us.com/9d9ec17e69369fbbf879bd6a713b3a40/684a576f/video/tos/useast8/tos-useast8-ve-0068c001-tx2/o4IyEQEQRlEMAcDnyFQVf9p98SeEuEJAVjpPB9/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=3224&bt=1612&cs=0&ds=6&ft=GSDrKInz7ThR2uqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZTtmaGQ6Zjg2O2g3ZGg4ZUBpM3dsaXg5cmU8djMzaTczNEBgMy4tX2FjNjIxLWItXjUtYSNyNDVtMmRrNm1gLS1kMTJzcw%3D%3D&vvpl=1&l=20250611222743DC21E78A0520AD050DA2&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/2ae4ae21ad13bd300fd2b7295da85bca/684a651d/video/tos/useast8/tos-useast8-ve-0068c004-tx2/ocQE0FoVjBOLEQDlIffqFVgAEPa6CG1M44TARw/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2216&bt=1108&cs=0&ds=6&ft=GSDrKInz7ThvWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=NDQ7ZDNpOzU6aGg6aDpmZUBpajg0aXQ5cm02MzMzaTczNEAwYDAvMzEtX14xMjJhNTM1YSNkbDZpMmQ0NmFhLS1kMTJzcw%3D%3D&vvpl=1&l=20250611232601380645385E184305A077&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/2e37a3a792c90a15afc8ce423811c8d7/684a576a/video/tos/useast5/tos-useast5-ve-0068c001-tx/o8IIqLP3TCGfHSGrEej3XkQAIYmeiVubmSIAjc/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2440&bt=1220&cs=0&ds=6&ft=GSDrKInz7ThR2uqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Zjo0OjxnZjxmNGdlaGc2PEBpM3k4eXU5cjY8eDMzZzczNEA2NWA0LTUzNi4xNTAuXjAxYSNlM21qMmRjZmlgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611222743DC21E78A0520AD050DA2&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/d0890fe508cd86351d3d2bb700eea452/684a6081/video/tos/useast5/tos-useast5-ve-0068c003-tx/ogfjQIQ5C3eFQOhTsVCfIMMBAgF6HQAwE6Dk4E/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2768&bt=1384&cs=0&ds=6&ft=GSDrKInz7ThKFuqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OWlkZjg0O2doPGczZmVoOkBpanBzZnU5cjpyMzMzZzczNEA0NWBgXjFeXjIxMTZhMjBfYSMtbjFyMmRrMTFhLS1kMS9zcw%3D%3D&vvpl=1&l=20250611230628ED92FE2EBEC9E0066891&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/2bab6057e83bf1fbc5df98e254afbdd3/684a6557/video/tos/useast5/tos-useast5-ve-0068c003-tx/ocZQBa5ykoBZiCKIKYZttg43EkGEAvi4pUcDW/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2874&bt=1437&cs=0&ds=6&ft=GSDrKInz7ThiWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ODtkNGU1N2lnM2k5NmZkOkBpanZwdHI5cjZreDMzZzczNEBhXjQ2LzVjNV8xLi9hYjQyYSNvNTJqMmRrZGBgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611232652165DB7529DD668065BCA&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/11f85bffba0ce91f0c1107edb51e28ad/684a653c/video/tos/useast5/tos-useast5-ve-0068c002-tx/o8egkRHCAApAHRnkjLe4BPGCfRtWEIIEvnEbA0/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2250&bt=1125&cs=0&ds=6&ft=GSDrKInz7ThiWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=OTU6NjZoNjw6OTw1ODw8NkBpajw3OnM5cmUzeTMzZzczNEBgMjRhXzQzNi4xMzY2YWBiYSMtL2RuMmRjbmFgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611232652165DB7529DD668065BCA&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/868a9ade46368cfb6a77713b7311fa23/684a6541/video/tos/useast8/tos-useast8-pve-0068-tx2/owAIgiLfoI7APMdRtQXeKLfVNGKslfgtVeFXnA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1644&bt=822&cs=0&ds=6&ft=GSDrKInz7ThiWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Zjk5NTU4OGk5ZDQ3NWhkZUBpM29xcHU5cml5eTMzaTczNEBeXl9jLTYvXzQxNDFeYGBeYSNeL2JgMmRjb15gLS1kMTJzcw%3D%3D&vvpl=1&l=20250611232652165DB7529DD668065BCA&btag=e00088000",
    "https://v16m.tiktokcdn-us.com/9fa4ca1d8e2972385bfc512fff15316b/684a658c/video/tos/useast5/tos-useast5-ve-0068c001-tx/oU3YNgGfQOFIP4yueRAAIEML9aaFxI3fTfKGI4/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1108&bt=554&cs=0&ds=6&ft=GSDrKInz7ThiWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=NTQ5Zmg0NDNmaTszOTM7PEBpM3V3ZXY5cnJwcjMzZzczNEAxMTEyMF80NV4xLmE1Y19eYSNmc2NlMmRrazNgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611232652165DB7529DD668065BCA&btag=e00090000",
    "https://v16m.tiktokcdn-us.com/0316017b15e7309ee5848236b7967670/684a652b/video/tos/useast5/tos-useast5-ve-0068c002-tx/ogiuepgAQ3ALsIZmfTMiseeUmkGqcKERSAbfR5/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1258&bt=629&cs=0&ds=6&ft=GSDrKInz7ThiWSqKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZzhkZTlmZTwzaTxpZTZoPEBpajtoOHU5cjhmeTMzZzczNEAwLzNgYDIwXi0xMl41L2EuYSNpNjYvMmQ0bXJgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611232652165DB7529DD668065BCA&btag=e000b8000",
    "https://v16m.tiktokcdn-us.com/afacfcd437c7c4da8becd0ac401cc72b/684a5754/video/tos/useast5/tos-useast5-ve-0068c001-tx/ogK5SxeEXIjjgIBQQCFPAvcDACkKEHe2fbOIHo/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1712&bt=856&cs=0&ds=6&ft=GSDrKInz7ThR2uqKXq8Zmo&mime_type=video_mp4&qs=0&rc=Ojw4Ojs2OzU6Zzo0OTloZEBpajg5PG45cjdneDMzZzczNEA0XjVeLV8wXl8xXmBjYF9gYSMtNC9gMmRrc2JgLS1kMS9zcw%3D%3D&vvpl=1&l=20250611222743DC21E78A0520AD050DA2&btag=e000b8000"
];

        // Variables
        let currentIndex = 0;
        let results = [];
        let isRunning = false;

        // Initialize
        function init() {
          // Display resources in the list
          resourcesList.innerHTML = "";
          resources.forEach((resource, index) => {
            const li = document.createElement("li");
            li.textContent = `Resource ${index + 1}: ${resource.substring(
              0,
              50
            )}...`;
            resourcesList.appendChild(li);
          });

          // Set total resources count
          totalResourcesEl.textContent = resources.length;
        }

        // Format bytes to readable format
        function formatBytes(bytes, decimals = 2) {
          if (bytes === 0) return "0 Bytes";
          const k = 1024;
          const dm = decimals < 0 ? 0 : decimals;
          const sizes = ["Bytes", "KB", "MB", "GB", "TB"];
          const i = Math.floor(Math.log(bytes) / Math.log(k));
          return (
            parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + " " + sizes[i]
          );
        }

        // Format speed
        function formatSpeed(bytes, milliseconds) {
          const seconds = milliseconds / 1000;
          const bytesPerSecond = bytes / seconds;
          return formatBytes(bytesPerSecond) + "/s";
        }

        // Get client IP address
        async function getClientIP() {
          try {
            const response = await fetch("https://api.ipify.org?format=json");
            const data = await response.json();
            return data.ip;
          } catch (error) {
            console.error("Error fetching client IP:", error);
            return "Unknown";
          }
        }

        // Get target IP address from hostname
        async function getTargetIP(url) {
          try {
            const hostname = new URL(url).hostname;
            // Note: This is a mock implementation since DNS lookups aren't directly possible in browser JavaScript
            // In a real implementation, you would need a server-side component or use a service
            return `${hostname} (IP lookup requires server-side code)`;
          } catch (error) {
            console.error("Error getting target IP:", error);
            return "Unknown";
          }
        }

        // Test resource
        async function testResource(url, index) {
          const row = document.createElement("tr");
          row.classList.add("testing");
          row.innerHTML = `
                  <td>${index + 1}</td>
                  <td>${url.substring(0, 50)}...</td>
                  <td>Testing...</td>
                  <td>Testing...</td>
                  <td>Testing...</td>
                  <td><span class="debug-toggle" data-index="${index}">Show Debug Info</span><div class="debug-info hidden" id="debug-${index}">Loading...</div></td>
                `;
          resultsBody.appendChild(row);

          try {
            const startTime = performance.now();
            const requestTime = new Date().toISOString();
            const clientIP = await getClientIP();
            const targetIP = await getTargetIP(url);

            // Fetch the resource
            const response = await fetch(url, {
              method: "GET",
              headers: {
                Range: "bytes=0-999999",
              },
              mode: "cors",
              cache: "no-cache",
            });

            // Get response headers
            const headers = {};
            response.headers.forEach((value, key) => {
              headers[key] = value;
            });

            const endTime = performance.now();
            const waitingTime = endTime - startTime;

            // Get content length from headers
            const contentLength = parseInt(headers["content-length"] || 0);
            const downloadSpeed =
              contentLength > 0
                ? formatSpeed(contentLength, waitingTime)
                : "N/A";

            // Create debug info
            const debugInfo = {
              resourceURL: url,
              clientIP,
              targetIP,
              requestTime,
              responseHeaders: headers,
              responseTime: new Date().toISOString(),
              responseStatus: response.status,
              responseStatusText: response.statusText,
            };

            // Update the debug info div
            const debugDiv = document.getElementById(`debug-${index}`);
            debugDiv.innerHTML = `
                    <h4>Resource URL:</h4>
                    <pre>${debugInfo.resourceURL}</pre>
                    <h4>Client IP:</h4>
                    <pre>${debugInfo.clientIP}</pre>
                    <h4>Target IP:</h4>
                    <pre>${debugInfo.targetIP}</pre>
                    <h4>Request Time:</h4>
                    <pre>${debugInfo.requestTime}</pre>
                    <h4>Response Time:</h4>
                    <pre>${debugInfo.responseTime}</pre>
                    <h4>Response Headers:</h4>
                    <pre>${JSON.stringify(
                      debugInfo.responseHeaders,
                      null,
                      2
                    )}</pre>
                  `;

            // Update the row with results
            row.classList.remove("testing");
            row.classList.add("completed");
            row.cells[2].textContent = waitingTime.toFixed(2);
            row.cells[3].textContent = downloadSpeed;
            row.cells[4].textContent = `${response.status} ${response.statusText}`;

            // Add to results
            results.push({
              url,
              waitingTime,
              downloadSpeed,
              status: response.status,
              debugInfo,
            });

            return true;
          } catch (error) {
            console.error(`Error testing resource ${index + 1}:`, error);

            // Update the debug info div with error
            const debugDiv = document.getElementById(`debug-${index}`);
            debugDiv.innerHTML = `
                    <h4>Error:</h4>
                    <pre>${error.message}</pre>
                  `;

            row.classList.remove("testing");
            row.classList.add("error");
            row.cells[2].textContent = "Error";
            row.cells[3].textContent = "Error";
            row.cells[4].textContent = error.message;

            // Add to results
            results.push({
              url,
              waitingTime: 0,
              downloadSpeed: "Error",
              status: "Error",
              error: error.message,
            });

            return false;
          }
        }

        // Run tests
        async function runTests() {
          isRunning = true;
          startBtn.disabled = true;
          resetBtn.disabled = true;
          calculateBtn.disabled = true;
          results = [];
          resultsBody.innerHTML = "";
          summaryCard.style.display = "none";

          let successCount = 0;

          for (let i = 0; i < resources.length; i++) {
            currentIndex = i;
            const success = await testResource(resources[i], i);
            if (success) successCount++;

            // Update progress
            const progress = ((i + 1) / resources.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${Math.round(progress)}%`;
          }

          // Enable buttons
          isRunning = false;
          startBtn.disabled = false;
          resetBtn.disabled = false;
          calculateBtn.disabled = false;

          // Update successful tests count
          successfulTestsEl.textContent = successCount;

          // Add event listeners for debug toggles
          document.querySelectorAll(".debug-toggle").forEach((toggle) => {
            toggle.addEventListener("click", function () {
              const index = this.getAttribute("data-index");
              const debugInfo = document.getElementById(`debug-${index}`);
              if (debugInfo.classList.contains("hidden")) {
                debugInfo.classList.remove("hidden");
                this.textContent = "Hide Debug Info";
              } else {
                debugInfo.classList.add("hidden");
                this.textContent = "Show Debug Info";
              }
            });
          });
        }

        // Calculate statistics
        function calculateStats() {
          if (results.length === 0) return;

          // Filter out errors
          const successfulResults = results.filter(
            (result) => result.status !== "Error"
          );

          if (successfulResults.length === 0) {
            avgWaitingTimeEl.textContent = "N/A";
            avgDownloadSpeedEl.textContent = "N/A";
            return;
          }

          // Calculate average waiting time
          const totalWaitingTime = successfulResults.reduce(
            (sum, result) => sum + result.waitingTime,
            0
          );
          const avgWaitingTime = totalWaitingTime / successfulResults.length;
          avgWaitingTimeEl.textContent = avgWaitingTime.toFixed(2) + " ms";

          // For download speed, we can only show a qualitative assessment
          avgDownloadSpeedEl.textContent = "See individual results";

          // Show summary card
          summaryCard.style.display = "block";
        }

        // Reset
        function reset() {
          if (isRunning) return;

          results = [];
          resultsBody.innerHTML = "";
          progressBar.style.width = "0%";
          progressText.textContent = "0%";
          summaryCard.style.display = "none";
          avgWaitingTimeEl.textContent = "-";
          avgDownloadSpeedEl.textContent = "-";
          successfulTestsEl.textContent = "-";
        }

        // Event listeners
        startBtn.addEventListener("click", runTests);
        resetBtn.addEventListener("click", reset);
        calculateBtn.addEventListener("click", calculateStats);

        // Initialize
        init();
      });
    </script>
  </body>
</html>
