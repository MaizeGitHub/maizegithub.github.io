<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Resource Tester with Debug Info</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .controls {
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: #45a049;
      }
      button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
      #startBtn {
        background-color: #4caf50;
      }
      #resetBtn {
        background-color: #f44336;
      }
      #calculateBtn {
        background-color: #2196f3;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }
      th {
        background-color: #f2f2f2;
        position: sticky;
        top: 0;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      tr.testing {
        background-color: #fff9c4;
      }
      tr.completed {
        background-color: #e8f5e9;
      }
      tr.error {
        background-color: #ffebee;
      }
      .summary-card {
        background-color: #e3f2fd;
        border-radius: 8px;
        padding: 15px;
        margin-top: 20px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .summary-card h2 {
        margin-top: 0;
        color: #1565c0;
      }
      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }
      .summary-item {
        background-color: white;
        padding: 15px;
        border-radius: 4px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .summary-item h3 {
        margin-top: 0;
        color: #333;
        font-size: 16px;
      }
      .summary-item p {
        margin-bottom: 0;
        font-size: 24px;
        font-weight: bold;
        color: #1565c0;
      }
      #videoContainer {
        display: none;
      }
      .progress-container {
        margin-top: 10px;
        background-color: #f5f5f5;
        border-radius: 4px;
        height: 20px;
        position: relative;
      }
      .progress-bar {
        height: 100%;
        background-color: #4caf50;
        border-radius: 4px;
        width: 0%;
        transition: width 0.3s;
      }
      .progress-text {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        text-align: center;
        line-height: 20px;
        color: white;
        font-weight: bold;
        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
      }
      .resources-list {
        margin-bottom: 20px;
        background-color: #f5f5f5;
        padding: 15px;
        border-radius: 4px;
      }
      .resources-list h2 {
        margin-top: 0;
        color: #333;
      }
      .resources-list ul {
        margin: 0;
        padding-left: 20px;
      }
      .resources-list li {
        margin-bottom: 5px;
      }
      .debug-info {
        background-color: #f0f8ff;
        border: 1px solid #b0c4de;
        border-radius: 4px;
        padding: 10px;
        margin-top: 10px;
        font-family: monospace;
        font-size: 12px;
        max-height: 200px;
        overflow-y: auto;
      }
      .debug-info h4 {
        margin-top: 0;
        margin-bottom: 5px;
        color: #333;
      }
      .debug-info pre {
        margin: 0;
        white-space: pre-wrap;
      }
      .debug-toggle {
        cursor: pointer;
        color: #1565c0;
        text-decoration: underline;
        font-size: 14px;
        margin-top: 5px;
        display: inline-block;
      }
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1>Video Resource Tester with Debug Info</h1>

    <div class="resources-list">
      <h2>Hardcoded Resources</h2>
      <ul id="resourcesList"></ul>
    </div>

    <div class="controls">
      <button id="startBtn">Start</button>
      <button id="resetBtn" disabled>Reset</button>
      <button id="calculateBtn" disabled>Calculate</button>
    </div>

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-text" id="progressText">0%</div>
    </div>

    <table id="resultsTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Resource URL</th>
          <th>Waiting Time (ms)</th>
          <th>Download Speed</th>
          <th>Status</th>
          <th>Debug Info</th>
        </tr>
      </thead>
      <tbody id="resultsBody"></tbody>
    </table>

    <div class="summary-card" id="summaryCard" style="display: none">
      <h2>Test Results Summary</h2>
      <div class="summary-grid">
        <div class="summary-item">
          <h3>Average Waiting Time</h3>
          <p id="avgWaitingTime">-</p>
        </div>
        <div class="summary-item">
          <h3>Average Download Speed</h3>
          <p id="avgDownloadSpeed">-</p>
        </div>
        <div class="summary-item">
          <h3>Total Resources</h3>
          <p id="totalResources">-</p>
        </div>
        <div class="summary-item">
          <h3>Successful Tests</h3>
          <p id="successfulTests">-</p>
        </div>
      </div>
    </div>

    <div id="videoContainer"></div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // DOM Elements
        const startBtn = document.getElementById("startBtn");
        const resetBtn = document.getElementById("resetBtn");
        const calculateBtn = document.getElementById("calculateBtn");
        const resultsBody = document.getElementById("resultsBody");
        const videoContainer = document.getElementById("videoContainer");
        const summaryCard = document.getElementById("summaryCard");
        const avgWaitingTimeEl = document.getElementById("avgWaitingTime");
        const avgDownloadSpeedEl = document.getElementById("avgDownloadSpeed");
        const totalResourcesEl = document.getElementById("totalResources");
        const successfulTestsEl = document.getElementById("successfulTests");
        const progressBar = document.getElementById("progressBar");
        const progressText = document.getElementById("progressText");
        const resourcesList = document.getElementById("resourcesList");

        // Hardcoded resources list
        const resources = [
          "https://v19.tiktokcdn-us.com/e965d8cf68fe9bab80cf74e54d805672/6842cfa7/video/tos/useast5/tos-useast5-pve-0068-tx/o0fKDf5AIEmkIDEJkgQAFCjUQGjBAeL8wHCFuQ/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1854&bt=927&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZDYzNGYzNjU8Njc6Nmg0O0BpMzd2N3Y5cmozMzMzZzczNEAvYl8xYl9hX14xYjU0NDQvYSNzX2JtMmQ0c15hLS1kMS9zcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/3de9907a4921489e0765430305da71db/6842cfa3/video/tos/useast5/tos-useast5-ve-0068c002-tx/oE1QhDfEYgqLnGqSCEByRgALDbIjFfEUD1GADo/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2384&bt=1192&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NWRoNjlpODw8ZGRkZzY4NEBpMzR4bXQ5cjQzeDMzZzczNEAyNGMzLzQuNi0xXy5hMzExYSNpLmNkMmRrbWhgLS1kMS9zcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/f8fc2ea3f94130d95fd3a1beff5acf16/6842ca2c/video/tos/useast5/tos-useast5-pve-0068-tx/os9UPxEULicgT94XBnD0WHszI2iBvbKWQZAPE/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2258&bt=1129&cs=0&ds=6&ft=GSDrKInz7ThbSCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NmQ3aTw6OTkzaTxmOmU7Z0Bpam53bHA5cmV3djMzZzczNEA0MDMwMTI0NmExXjAyXzIuYSNfamhyMmQ0M2xgLS1kMS9zcw%3D%3D&vvpl=1&l=202506060459323C3F3D7B36227017B2C5&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/20e42897c4c15a1b5f337db8282a60b0/6842c68a/video/tos/useast8/tos-useast8-ve-0068c001-tx2/o4nhQdCOIAgIdqjQEEXHfgyA7YkDuFkdfqFegI/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1742&bt=871&cs=0&ds=6&ft=GSDrKInz7Th_dCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZTVkZzk3M2U0ZzM5aDgzM0BpM3Mzdmw5cnB5dzMzaTczNEAzM2NgYi8tNl4xNTQtXmJhYSMxMjM2MmQ0YmJgLS1kMTJzcw%3D%3D&vvpl=1&l=20250606044405A4ADD4C8E537F31729DA&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/48a0fef668a084b41bfb0eb726b8a459/6842cfaa/video/tos/useast5/tos-useast5-pve-0068-tx/o4ub74KXZkIBuJUUDcLAguPkEIY4iPBIBQ2iE/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1920&bt=960&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NTw0OTw5NDU6OzlkOzpkN0BpMztmM3A5cjt1cDMzZzczNEBjL15jLjJgNjIxYTRgMV8yYSNmZjZgMmQ0ZHFgLS1kMS9zcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/fd98d8ab9567917960525d9e5a0db775/6842cfaf/video/tos/useast5/tos-useast5-ve-0068c004-tx/oofoPjRpEbDICFHETeFgCQKDDEJmIgB9vjgSJA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2170&bt=1085&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=PGczaDc8ZTQ0M2g3OjhoO0BpM2s4Zng5cjNpMzMzZzczNEAuYzBiMi5hXy0xNmE1MV81YSNlMGxmMmRrZGVhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e00088000",
          "https://v19.tiktokcdn-us.com/dd808a0a8dd0360281f513a860a869ff/6842cfb7/video/tos/useast5/tos-useast5-pve-0068-tx/oMIoSvAAkmAW5QaZefjUpw8BHqMfHCjiiAAPCD/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1700&bt=850&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ODw5NGhoZmU3M2hpZWdkZ0BpamxuN285cm9neTMzZzczNEAvL2BgMDVeXi8xLTI1YjJjYSNnNS4xMmRzXmRgLS1kMS9zcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e00088000",
          "https://v16m.tiktokcdn-us.com/12f45ce0ab91a68712c6c9bc40bb4b2f/6842c2f8/video/tos/useast8/tos-useast8-pve-0068-tx2/ogeRdQoMAeHF0qnW88dGQgAqQOzeK5IzeDB7RU/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2312&bt=1156&cs=0&ds=6&ft=GSDrKInz7ThiBbgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NGc3NDppOmU6PDozOWRlOkBpM3lud285cmp5dzMzaTczNEAzXl4uMC4wNTMxXzJiYjItYSNeZ3E1MmRjXnBgLS1kMTJzcw%3D%3D&vvpl=1&l=20250606042844A36D212032FCF6162BD7&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/f9a43c47bc351596964bbcc226726939/6842cf9e/video/tos/useast5/tos-useast5-pve-0068-tx/ooWDKxoIQM7DlBd2gBSJGfEeFEARZgKi6Y5QDQ/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1522&bt=761&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=Zjg5aDc1aDY0OTRlaDw4Z0BpM3d1NGs5cmo5MzMzZzczNEAwMzY0L2EtX2ExYDFgYS9hYSNqbWUxMmRjbGhhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/1a0f9b2cac09a39acd1e1b47d2bf7567/6842cfc9/video/tos/useast8/tos-useast8-pve-0068-tx2/ooAIe8stfAtjMAGEQ7OQAvCqZIWWIFg0NfZ91O/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1838&bt=919&cs=0&ds=6&ft=GSDrKInz7Th07CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NTo1NGhlNjo3ZWlnZmQ6M0BpM3l3dWs5cmdwdDMzaTczNEBfLy01Ni9iXmMxX2BjMDMwYSNzc2hvMmRzM2pgLS1kMTJzcw%3D%3D&vvpl=1&l=202506060522522912BC8E5067BE1B1F40&btag=e00090000",
          "https://v19.tiktokcdn-us.com/fe5198708e328a461620b97cf8b26db2/6842cffa/video/tos/useast5/tos-useast5-pve-0068-tx/oYVUQ8feMHkQXJLI3OQzZNIwHCkE2e6AsOjspA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=5244&bt=2622&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NWhnaTo5ZThkZmg8Zjo5Z0BpM2llZ3c5cmhmMzMzZzczNEAzYjQuY2ItNjExL2JeNDA2YSNzcXBnMmRzbjRhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e00090000",
          "https://v19.tiktokcdn-us.com/23d6b001700f8855b3eda12609fe6cea/6842cfe7/video/tos/useast5/tos-useast5-pve-0068-tx/ocrvA6DgBIPKFPna5kfCjcovEx1tefIWAEH6AQ/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1720&bt=860&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZTk6PDM5ZGk4ZzY6ZDc8M0BpanRnOHI5cmR5eTMzZzczNEBfLV8yYDYtX2MxMy4yYTBgYSNyNHFrMmQ0YW5gLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e00088000",
          "https://v16m.tiktokcdn-us.com/2f99243a4bd83dbd15b665787dd8feaf/6842c49b/video/tos/useast5/tos-useast5-ve-0068c002-tx/o8Sn9kkRXIqYEaeDEm2gtlDhF8fQABhDTEb3yu/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2026&bt=1013&cs=0&ds=6&ft=GSDrKInz7Th7ZCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=aWQ8M2dlNDkzNTdoZjdnZkBpM3E1cWo5cnlwdTMzZzczNEAwMy4tLi1jNmIxLV9gYF8zYSNmYmduMmQ0Zm9gLS1kMS9zcw%3D%3D&vvpl=1&l=2025060604354108AA268525CEF516CBAF&btag=e00088000",
          "https://v19.tiktokcdn-us.com/b2fcf44a2df7c632edd990061e9b061f/6842cfcb/video/tos/useast5/tos-useast5-ve-0068c002-tx/o40C3oiEKIBhwxQAV1rwf1ir0hEwI4aBpCBNrA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2210&bt=1105&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=OTk8OTQ4Z2hoMztmZWQ8aUBpamRld2s5cnJ0MzMzZzczNEBfY2AuYC9jXmExMTNeXi9fYSNuYl9pMmRjaWRhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/a8409b5d24cfe503a9c178db6dd51ace/6842c8ef/video/tos/useast5/tos-useast5-pve-0068-tx/owFDFCJNfI77BY88QgLDEfMdkAOEQIAvDHpjAe/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=3268&bt=1634&cs=0&ds=6&ft=GSDrKInz7ThAICgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZjY7ZzU4Zjc3NjRlOTg3aEBpMzNtZ3c5cjp5MzMzZzczNEAvYzUuYzVgNV4xXzE1MzMtYSNnNnBnMmRjcmJhLS1kMS9zcw%3D%3D&vvpl=1&l=2025060604541085F028CA0220371A4264&btag=e00088000",
          "https://v19.tiktokcdn-us.com/91fc427d8a381fc4b2f657ceb5025f07/6842cfd1/video/tos/useast8/tos-useast8-ve-0068c003-tx2/osVYGukRiQ1SEx0EEoMA2YD8FGfgABhE8I7Ye1/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1626&bt=813&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZDNlZWgzMzc5PDY4aTY8NUBpams3aHg5cjRmMzMzaTczNEA1YTBeNjAyX2ExLmM2Ml41YSNfbGVhMmRrYGBhLS1kMTJzcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/cb491d91094decc3b6361ef5c09c3f8a/6842cfd1/video/tos/useast5/tos-useast5-ve-0068c003-tx/oUPZJsIRgHAQDUSe4sLkW8iPEenueIAVGC1jAA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2456&bt=1228&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=aGk4ZzpnaDhmMzc2ZGc5ZEBpamxocWo5cnJ0MzMzZzczNEAxLTM2YWAvNTAxMmAxNDMxYSM1NGUvMmRjbWZhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/01c6977ba2b88fd5c9ec1d266c7287c5/6842c8e9/video/tos/useast8/tos-useast8-pve-0068-tx2/owPIoE9ZAAmjgDpTMLe6efGK4DODfIifRXOdQO/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2394&bt=1197&cs=0&ds=6&ft=GSDrKInz7ThAICgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZzQ4NDNkNmU2Mzg3ZTszNUBpajxoaXQ5cm1peTMzaTczNEA0NV4wYjIzXmIxYGEwYGMwYSNzc2g1MmRrNjRgLS1kMTJzcw%3D%3D&vvpl=1&l=2025060604541085F028CA0220371A4264&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/b160705fa4dc8be53a27b58ac00c888c/6842cfd4/video/tos/useast5/tos-useast5-ve-0068c001-tx/osCAABEvj2DJR0g2mAj0FaVDf2SgYoIEeTQQa1/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2710&bt=1355&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZmYzZmVnOjVpOWg3ZGk4NEBpM3U6NnU5cjdpMzMzZzczNEA2MGMtM18uNmMxMTYuYGAyYSMtaDYtMmQ0ZzJhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e000b8000",
          "https://v19.tiktokcdn-us.com/b82109475415ae208f3e9e276beb651a/6842cfcf/video/tos/useast8/tos-useast8-pve-0068-tx2/oswIY4XAIQMeLfgAxy1A85Q5QCIEj9eIqGIjPC/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2348&bt=1174&cs=0&ds=6&ft=GSDrKInz7ThMPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=Njc4NDM6Ojk2ZGhmPGVnOkBpajd2Onk5cjxrMzMzaTczNEBgNjAwLmAtNWAxLi5gMS0yYSNgbGdzMmRjcC1hLS1kMTJzcw%3D%3D&vvpl=1&l=202506060523359FC5B04DF332721B2430&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/491ead1a2f13528e3e0df0cbf7f82c2c/6842ca4e/video/tos/useast8/tos-useast8-ve-0068c004-tx2/owERPn8BJyPEEfFR1rIgsIAVFjAfwr8PW6RQbD/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=3076&bt=1538&cs=0&ds=6&ft=GSDrKInz7ThP0CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=O2g2OzdoODtlaDtnZWQ6O0BpM29lZHg5cnR2dzMzaTczNEAyNV4vLy0wNjIxMF8tMzUuYSNwZjEvMmRzNDBgLS1kMTJzcw%3D%3D&vvpl=1&l=202506060459507E4AAF76A740131A484E&btag=e00088000",
          "https://v16m.tiktokcdn-us.com/c343e7ded024d87b4fc5fc72e37e10d8/6842cfc4/video/tos/useast5/tos-useast5-ve-0068c001-tx/oUuJ4QUiavBEDBD6BDT3cAEFnyCQIgcxBEiw7/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1474&bt=737&cs=0&ds=6&ft=GSDrKInz7ThXPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=Ozw7ZTNmZTdpOjU6NTNpNEBpMzg6M2w5cjZrMzMzZzczNEBiMV4yLS9eNl4xYV9iM2JeYSNsaG1rMmRrM2dhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523363352A3AD4B28A521ECBD&btag=e000b0000",
          "https://v16m.tiktokcdn-us.com/d9a421890079bad4a86b8299c7ff784a/6842cfd2/video/tos/useast5/tos-useast5-ve-0068c001-tx/oggEpIwEBKmM4AB6wifnAFQnoiRwE0BCHzvIxn/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2944&bt=1472&cs=0&ds=6&ft=GSDrKInz7ThXPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=ZjVmMzZpOjo5NTQ5Nzw5NEBpanRkdm05cnJqMzMzZzczNEAwYjUxNS9eX2AxY2EzNDI1YSNrZS41MmRjYGdhLS1kMS9zcw%3D%3D&vvpl=1&l=202506060523363352A3AD4B28A521ECBD&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/bd1b9dd1bd7b2601c82a309df4612a6f/6842c795/video/tos/useast8/tos-useast8-ve-0068c002-tx2/oQmEgVsjQlzEV3xBQKUDfE8RsKAFguSAEaenIl/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2896&bt=1448&cs=0&ds=6&ft=GSDrKInz7ThGACgKXq8Zmo&mime_type=video_mp4&qs=0&rc=PDk2NGc7Z2ZlOmQ4aTk6OkBpMzs0ZnM5cjVseTMzaTczNEAxNWE0MzQ0NWExLTUvNi42YSNjYGptMmRrai9gLS1kMTJzcw%3D%3D&vvpl=1&l=20250606044840BF6E13115D61A2174396&btag=e000b0000",
          "https://v16m.tiktokcdn-us.com/e295a58e95923ed7bb60cd607b62c8f9/6842c6e8/video/tos/useast8/tos-useast8-ve-0068c001-tx2/ocwDjAiexqgAlIIQZYLeICAjfHCRjgQcjFGNIz/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1536&bt=768&cs=0&ds=6&ft=GSDrKInz7ThzjCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NjNlPGc4OWU3Z2VoZzdnO0BpM2k4bW05cnhyMzMzaTczNEAtLy5iMWMwXi8xLTYvNS8zYSNsZS5fMmRjbGxhLS1kMTJzcw%3D%3D&vvpl=1&l=2025060604453231AE299B898D271967AF&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/b467c292dc9405ab195ee8b1fa38469c/6842cfe5/video/tos/useast8/tos-useast8-ve-0068c003-tx2/oULCqOgZwFkMABVJ7o1AVWAICEQffEZDIxY7wH/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1490&bt=745&cs=0&ds=6&ft=GSDrKInz7ThXPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=OjY6Njo6aTM8OmRlOTk4Z0BpM2ZxOHQ5cjNlMzMzaTgzNEA1MS9iNWEzXmAxXmBeY2MtYSNnMV9wMmQ0LnBhLS1kLzJzcw%3D%3D&vvpl=1&l=202506060523363352A3AD4B28A521ECBD&btag=e00088000",
          "https://v16m.tiktokcdn-us.com/d238c50057b57db51e16a98e9c15e176/6842cabc/video/tos/useast8/tos-useast8-ve-0068c002-tx2/oIMLgfhhDIfPF6mIDaEKEgQStCqI54CAvcjifA/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=2090&bt=1045&cs=0&ds=6&ft=GSDrKInz7ThpyCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NzU0MzM1NTZlODU5PDg0ZUBpM2pmZnE5cmo1eTMzaTczNEAwNi8yNTNeXjQxNi82Mi9eYSNyLzNyMmRzY2FgLS1kMTJzcw%3D%3D&vvpl=1&l=2025060605012906A5E8D0A9077C16E7E1&btag=e00088000",
          "https://v16m.tiktokcdn-us.com/e3fdacb85b4edd1f57c68bf893de7b6f/6842c6e5/video/tos/useast5/tos-useast5-pve-0068-tx/os2BiAmNFC4WtYxIIQC0ifdopuB20EAZ3BjIwj/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1482&bt=741&cs=0&ds=6&ft=GSDrKInz7ThzjCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NDNlOjpoZzo7PDo7ZTo3OEBpamd0cHI5cm5lMzMzZzczNEBiNDBeMmMtXy4xYzMzNV4vYSNiNGAzMmRjZTFhLS1kMS9zcw%3D%3D&vvpl=1&l=2025060604453231AE299B898D271967AF&btag=e000b8000",
          "https://v16m.tiktokcdn-us.com/4e4a69135a081b4d0770f159623d2af7/6842c9b0/video/tos/useast5/tos-useast5-pve-0068-tx/owytgyCOHATRdnrENITeeAmAJTeG5LnHPkL5ME/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1672&bt=836&cs=0&ds=6&ft=GSDrKInz7Tha3CgKXq8Zmo&mime_type=video_mp4&qs=0&rc=Mzg8aWQzZzU8ZjM8aTs1aUBpanNmZHM5cnQ6dzMzZzgzNEA1NC8xLjVeNmAxYWEyYjYyYSNkMm5yMmRjZW1gLS1kLy9zcw%3D%3D&vvpl=1&l=202506060457202C0F45D723EF3A19F625&btag=e00088000",
          "https://v16m.tiktokcdn-us.com/e9a0793cd0a01d7e61af9ed36af14bd9/6842cfde/video/tos/useast8/tos-useast8-pve-0068-tx2/oIAEP6pAQt2IqnPC5fHDfIijfMAFg48AH0TQIr/?a=1180&bti=cWxkbHZsfGhkdzF3anZsZnJmbHFvbWtcZHFvcHBlZmsrYjo%3D&ch=0&cr=0&dr=0&er=0&lr=default&cd=0%7C0%7C0%7C0&cv=1&br=1714&bt=857&cs=0&ds=6&ft=GSDrKInz7ThXPCgKXq8Zmo&mime_type=video_mp4&qs=0&rc=NDVlNGg8ZzdpaTg6ZjtoOEBpanZ5Z3U5cm14MzMzaTczNEA0MTVjMjAzX18xX2M1LzRfYSNsNmBfMmQ0Y2NhLS1kMTJzcw%3D%3D&vvpl=1&l=202506060523363352A3AD4B28A521ECBD&btag=e00088000",
        ];

        // Variables
        let currentIndex = 0;
        let results = [];
        let isRunning = false;

        // Initialize
        function init() {
          // Display resources in the list
          resourcesList.innerHTML = "";
          resources.forEach((resource, index) => {
            const li = document.createElement("li");
            li.textContent = `Resource ${index + 1}: ${resource.substring(
              0,
              50
            )}...`;
            resourcesList.appendChild(li);
          });

          // Set total resources count
          totalResourcesEl.textContent = resources.length;
        }

        // Format bytes to readable format
        function formatBytes(bytes, decimals = 2) {
          if (bytes === 0) return "0 Bytes";
          const k = 1024;
          const dm = decimals < 0 ? 0 : decimals;
          const sizes = ["Bytes", "KB", "MB", "GB", "TB"];
          const i = Math.floor(Math.log(bytes) / Math.log(k));
          return (
            parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + " " + sizes[i]
          );
        }

        // Format speed
        function formatSpeed(bytes, milliseconds) {
          const seconds = milliseconds / 1000;
          const bytesPerSecond = bytes / seconds;
          return formatBytes(bytesPerSecond) + "/s";
        }

        // Get client IP address
        async function getClientIP() {
          try {
            const response = await fetch("https://api.ipify.org?format=json");
            const data = await response.json();
            return data.ip;
          } catch (error) {
            console.error("Error fetching client IP:", error);
            return "Unknown";
          }
        }

        // Get target IP address from hostname
        async function getTargetIP(url) {
          try {
            const hostname = new URL(url).hostname;
            // Note: This is a mock implementation since DNS lookups aren't directly possible in browser JavaScript
            // In a real implementation, you would need a server-side component or use a service
            return `${hostname} (IP lookup requires server-side code)`;
          } catch (error) {
            console.error("Error getting target IP:", error);
            return "Unknown";
          }
        }

        // Test resource
        async function testResource(url, index) {
          const row = document.createElement("tr");
          row.classList.add("testing");
          row.innerHTML = `
                  <td>${index + 1}</td>
                  <td>${url.substring(0, 50)}...</td>
                  <td>Testing...</td>
                  <td>Testing...</td>
                  <td>Testing...</td>
                  <td><span class="debug-toggle" data-index="${index}">Show Debug Info</span><div class="debug-info hidden" id="debug-${index}">Loading...</div></td>
                `;
          resultsBody.appendChild(row);

          try {
            const startTime = performance.now();
            const requestTime = new Date().toISOString();
            const clientIP = await getClientIP();
            const targetIP = await getTargetIP(url);

            // Fetch the resource
            const response = await fetch(url, {
              method: "HEAD",
              mode: "cors",
              cache: "no-cache",
            });

            // Get response headers
            const headers = {};
            response.headers.forEach((value, key) => {
              headers[key] = value;
            });

            const endTime = performance.now();
            const waitingTime = endTime - startTime;

            // Get content length from headers
            const contentLength = parseInt(headers["content-length"] || 0);
            const downloadSpeed =
              contentLength > 0
                ? formatSpeed(contentLength, waitingTime)
                : "N/A";

            // Create debug info
            const debugInfo = {
              resourceURL: url,
              clientIP,
              targetIP,
              requestTime,
              responseHeaders: headers,
              responseTime: new Date().toISOString(),
              responseStatus: response.status,
              responseStatusText: response.statusText,
            };

            // Update the debug info div
            const debugDiv = document.getElementById(`debug-${index}`);
            debugDiv.innerHTML = `
                    <h4>Resource URL:</h4>
                    <pre>${debugInfo.resourceURL}</pre>
                    <h4>Client IP:</h4>
                    <pre>${debugInfo.clientIP}</pre>
                    <h4>Target IP:</h4>
                    <pre>${debugInfo.targetIP}</pre>
                    <h4>Request Time:</h4>
                    <pre>${debugInfo.requestTime}</pre>
                    <h4>Response Time:</h4>
                    <pre>${debugInfo.responseTime}</pre>
                    <h4>Response Headers:</h4>
                    <pre>${JSON.stringify(
                      debugInfo.responseHeaders,
                      null,
                      2
                    )}</pre>
                  `;

            // Update the row with results
            row.classList.remove("testing");
            row.classList.add("completed");
            row.cells[2].textContent = waitingTime.toFixed(2);
            row.cells[3].textContent = downloadSpeed;
            row.cells[4].textContent = `${response.status} ${response.statusText}`;

            // Add to results
            results.push({
              url,
              waitingTime,
              downloadSpeed,
              status: response.status,
              debugInfo,
            });

            return true;
          } catch (error) {
            console.error(`Error testing resource ${index + 1}:`, error);

            // Update the debug info div with error
            const debugDiv = document.getElementById(`debug-${index}`);
            debugDiv.innerHTML = `
                    <h4>Error:</h4>
                    <pre>${error.message}</pre>
                  `;

            row.classList.remove("testing");
            row.classList.add("error");
            row.cells[2].textContent = "Error";
            row.cells[3].textContent = "Error";
            row.cells[4].textContent = error.message;

            // Add to results
            results.push({
              url,
              waitingTime: 0,
              downloadSpeed: "Error",
              status: "Error",
              error: error.message,
            });

            return false;
          }
        }

        // Run tests
        async function runTests() {
          isRunning = true;
          startBtn.disabled = true;
          resetBtn.disabled = true;
          calculateBtn.disabled = true;
          results = [];
          resultsBody.innerHTML = "";
          summaryCard.style.display = "none";

          let successCount = 0;

          for (let i = 0; i < resources.length; i++) {
            currentIndex = i;
            const success = await testResource(resources[i], i);
            if (success) successCount++;

            // Update progress
            const progress = ((i + 1) / resources.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${Math.round(progress)}%`;
          }

          // Enable buttons
          isRunning = false;
          startBtn.disabled = false;
          resetBtn.disabled = false;
          calculateBtn.disabled = false;

          // Update successful tests count
          successfulTestsEl.textContent = successCount;

          // Add event listeners for debug toggles
          document.querySelectorAll(".debug-toggle").forEach((toggle) => {
            toggle.addEventListener("click", function () {
              const index = this.getAttribute("data-index");
              const debugInfo = document.getElementById(`debug-${index}`);
              if (debugInfo.classList.contains("hidden")) {
                debugInfo.classList.remove("hidden");
                this.textContent = "Hide Debug Info";
              } else {
                debugInfo.classList.add("hidden");
                this.textContent = "Show Debug Info";
              }
            });
          });
        }

        // Calculate statistics
        function calculateStats() {
          if (results.length === 0) return;

          // Filter out errors
          const successfulResults = results.filter(
            (result) => result.status !== "Error"
          );

          if (successfulResults.length === 0) {
            avgWaitingTimeEl.textContent = "N/A";
            avgDownloadSpeedEl.textContent = "N/A";
            return;
          }

          // Calculate average waiting time
          const totalWaitingTime = successfulResults.reduce(
            (sum, result) => sum + result.waitingTime,
            0
          );
          const avgWaitingTime = totalWaitingTime / successfulResults.length;
          avgWaitingTimeEl.textContent = avgWaitingTime.toFixed(2) + " ms";

          // For download speed, we can only show a qualitative assessment
          avgDownloadSpeedEl.textContent = "See individual results";

          // Show summary card
          summaryCard.style.display = "block";
        }

        // Reset
        function reset() {
          if (isRunning) return;

          results = [];
          resultsBody.innerHTML = "";
          progressBar.style.width = "0%";
          progressText.textContent = "0%";
          summaryCard.style.display = "none";
          avgWaitingTimeEl.textContent = "-";
          avgDownloadSpeedEl.textContent = "-";
          successfulTestsEl.textContent = "-";
        }

        // Event listeners
        startBtn.addEventListener("click", runTests);
        resetBtn.addEventListener("click", reset);
        calculateBtn.addEventListener("click", calculateStats);

        // Initialize
        init();
      });
    </script>
  </body>
</html>
